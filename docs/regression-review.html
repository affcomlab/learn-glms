<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aaron Matthew Simmons and Jeffrey M. Girard">

<title>Introduction to Generalized Linear Modeling - 2&nbsp; Regression Recap</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./linear-models.html" rel="next">
<link href="./intro.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Introduction to Generalized Linear Modeling</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
    <a href="https://www.github.com/affcomlab/learn-glms/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./regression-review.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Regression Recap</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-review.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Regression Recap</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Appendix</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-demonstration" id="toc-data-demonstration" class="nav-link active" data-scroll-target="#data-demonstration"><span class="header-section-number">2.1</span> Data Demonstration</a></li>
  <li><a href="#loading-the-packages-and-reading-in-data" id="toc-loading-the-packages-and-reading-in-data" class="nav-link" data-scroll-target="#loading-the-packages-and-reading-in-data"><span class="header-section-number">2.2</span> Loading the Packages and Reading in Data</a></li>
  <li><a href="#prepare-data-exploratory-data-analysis" id="toc-prepare-data-exploratory-data-analysis" class="nav-link" data-scroll-target="#prepare-data-exploratory-data-analysis"><span class="header-section-number">2.3</span> Prepare Data / Exploratory Data Analysis</a></li>
  <li><a href="#simple-regression-example" id="toc-simple-regression-example" class="nav-link" data-scroll-target="#simple-regression-example"><span class="header-section-number">3</span> Simple Regression Example</a>
  <ul class="collapse">
  <li><a href="#parameter-table" id="toc-parameter-table" class="nav-link" data-scroll-target="#parameter-table"><span class="header-section-number">3.1</span> Parameter Table</a></li>
  <li><a href="#effect-sizes" id="toc-effect-sizes" class="nav-link" data-scroll-target="#effect-sizes"><span class="header-section-number">3.2</span> Effect Sizes</a></li>
  <li><a href="#model-performance" id="toc-model-performance" class="nav-link" data-scroll-target="#model-performance"><span class="header-section-number">3.3</span> Model Performance</a></li>
  <li><a href="#ploting-model-predictions" id="toc-ploting-model-predictions" class="nav-link" data-scroll-target="#ploting-model-predictions"><span class="header-section-number">3.4</span> Ploting Model Predictions</a></li>
  </ul></li>
  <li><a href="#multiple-regression-examples" id="toc-multiple-regression-examples" class="nav-link" data-scroll-target="#multiple-regression-examples"><span class="header-section-number">4</span> Multiple Regression Examples</a>
  <ul class="collapse">
  <li><a href="#two-continuous-predictors" id="toc-two-continuous-predictors" class="nav-link" data-scroll-target="#two-continuous-predictors"><span class="header-section-number">4.1</span> Two Continuous Predictors</a>
  <ul class="collapse">
  <li><a href="#parameter-table-and-interpretation" id="toc-parameter-table-and-interpretation" class="nav-link" data-scroll-target="#parameter-table-and-interpretation"><span class="header-section-number">4.1.1</span> Parameter Table and Interpretation</a></li>
  </ul></li>
  <li><a href="#one-dummy-coded-predictor" id="toc-one-dummy-coded-predictor" class="nav-link" data-scroll-target="#one-dummy-coded-predictor"><span class="header-section-number">4.2</span> One Dummy Coded Predictor</a>
  <ul class="collapse">
  <li><a href="#estimating-means-and-plot" id="toc-estimating-means-and-plot" class="nav-link" data-scroll-target="#estimating-means-and-plot"><span class="header-section-number">4.2.1</span> Estimating means and plot</a></li>
  <li><a href="#contrast" id="toc-contrast" class="nav-link" data-scroll-target="#contrast"><span class="header-section-number">4.2.2</span> Contrast</a></li>
  </ul></li>
  <li><a href="#one-continuous-and-one-dummy-coded-predictor" id="toc-one-continuous-and-one-dummy-coded-predictor" class="nav-link" data-scroll-target="#one-continuous-and-one-dummy-coded-predictor"><span class="header-section-number">4.3</span> One Continuous and One Dummy Coded Predictor</a>
  <ul class="collapse">
  <li><a href="#estimating-means" id="toc-estimating-means" class="nav-link" data-scroll-target="#estimating-means"><span class="header-section-number">4.3.1</span> Estimating Means</a></li>
  </ul></li>
  <li><a href="#moderation" id="toc-moderation" class="nav-link" data-scroll-target="#moderation"><span class="header-section-number">4.4</span> Moderation</a></li>
  </ul></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">5</span> Assumptions</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">6</span> Conclusion</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://www.github.com/affcomlab/learn-glms/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Regression Recap</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Before jumping into generalized linear models (GLMs), we will recap important foundations of general linear models, such as simple and multiple regression. The key is that generalized linear models are useful when assumptions of general linear models no longer hold or are unreasonable.</p>
<section id="data-demonstration" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data-demonstration"><span class="header-section-number">2.1</span> Data Demonstration</h2>
<p>In this data demo, we will first review loading <i>R</i> packages and data, then simple and multiple linear regression.</p>
<p>The data for this chapter is toy data about academic performance after obtaining a Ph.D.&nbsp;including salary information. It is composed of both continuous and categorical variables.</p>
<ul>
<li>Data: <a href="./yearspub.csv" download=""> yearspub.csv </a></li>
</ul>
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 46%">
<col style="width: 16%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th style="text-align: left;">Description</th>
<th style="text-align: right;">Values</th>
<th style="text-align: center;">Measurement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>yrs_since_phd</code></td>
<td style="text-align: left;">Years since obtaining Ph.D.</td>
<td style="text-align: right;">Integer</td>
<td style="text-align: center;">Scale</td>
</tr>
<tr class="even">
<td><code>n_cites</code></td>
<td style="text-align: left;">Number of Academic Citations</td>
<td style="text-align: right;">Integer</td>
<td style="text-align: center;">Scale</td>
</tr>
<tr class="odd">
<td><code>salary</code></td>
<td style="text-align: left;">Current Salary Figures</td>
<td style="text-align: right;">Integer</td>
<td style="text-align: center;">Scale</td>
</tr>
<tr class="even">
<td><code>n_pubs</code></td>
<td style="text-align: left;">Number of Academic Publications</td>
<td style="text-align: right;">Integer</td>
<td style="text-align: center;">Scale</td>
</tr>
<tr class="odd">
<td><code>sex</code></td>
<td style="text-align: left;">Male or Female</td>
<td style="text-align: right;">Characters</td>
<td style="text-align: center;">Nominal</td>
</tr>
</tbody>
</table>
</section>
<section id="loading-the-packages-and-reading-in-data" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="loading-the-packages-and-reading-in-data"><span class="header-section-number">2.2</span> Loading the Packages and Reading in Data</h2>
<p>In <i>R</i>, packages must be installed before using them. Once installed, then they can be activated in session with the <code>library()</code> command.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>One way of installing new <i>R</i> packages is to use the <code>install.packages()</code> <a href="https://www.rdocumentation.org/packages/utils/versions/3.6.2/topics/install.packages">command</a></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Read in data from file</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>yearspubs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"yearspubs.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>read_csv()</code> comes from the <code>tidyverse</code> package. As used here, by default it assumes that the file <i>yearspubs.csv</i> is in the same folder directory as the <i>R</i> analysis file.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Each package we load provides functionality:</p>
<ul>
<li><p><code>easystats</code>: For making table outputs from the models. <a href="https://cran.r-project.org/web/packages/easystats/easystats.pdf"><code>easystats</code> package documentation</a></p></li>
<li><p><code>tidyverse</code>: Provides a suite of easier to use analysis commands. <a href="https://cran.r-project.org/web/packages/tidyverse/tidyverse.pdf"><code>tidyverse</code> package documentation</a></p></li>
<li><p><code>ggeffects</code>: Provides plotting and visualizations of the models. <a href="https://cran.r-project.org/web/packages/ggeffects/ggeffects.pdf"><code>ggeffects</code> package documentation</a></p></li>
</ul>
</div>
</div>
</section>
<section id="prepare-data-exploratory-data-analysis" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="prepare-data-exploratory-data-analysis"><span class="header-section-number">2.3</span> Prepare Data / Exploratory Data Analysis</h2>
<p>It is always a good first step to plot data prior to fitting any model.</p>
<p>First, let’s consider the distributions, as histograms, of <code>years_since_phd</code> and <code>salary</code> using the <code>ggplot()</code> function<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>yearspubs, <span class="fu">aes</span>(years_since_phd)) <span class="sc">+</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="regression-review_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice that <code>years_since_phd</code> appears somewhat positively skewed (to the right tail).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>yearspubs, <span class="fu">aes</span>(salary)) <span class="sc">+</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="regression-review_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In contrast to <code>years_since_phd</code>, notice that <code>salary</code> is more normally distributed.</p>
<p>Now, we consider the relationship between <code>years_since_phd</code> and <code>salary</code> using a scatterplot. Notice that, for the most part, we can see a linear relationship such that salary tends to increase with the number of additional years after obtaining a Ph.D.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Explore salary-seniority relationship</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> yearspubs, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> years_since_phd, <span class="at">y =</span> salary)) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression-review_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="simple-regression-example" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Simple Regression Example</h1>
<p>Now, we will fit a simple linear regression with <code>salary</code> as the outcome variable and <code>years_since_phd</code> as the predictor variable using the <code>lm()</code> function, and consider the results. We will then print a summary table of the model results using the <code>model_parameters()</code> function from the <code>easystats</code> package. Therefore, <code>model_paramters()</code> shows the model’s estimated coefficient values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit linear model and print parameters</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> salary <span class="sc">~</span> years_since_phd,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> yearspubs</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(fit)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameter       | Coefficient |      SE |               95% CI | t(60) |      p</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -------------------------------------------------------------------------------</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)     |    45625.47 | 2473.12 | [40678.49, 50572.46] | 18.45 | &lt; .001</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="do">## years since phd |     1400.94 |  308.87 | [  783.12,  2018.77] |  4.54 | &lt; .001</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   using a Wald t-distribution approximation.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="lm() syntax">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
lm() syntax
</div>
</div>
<div class="callout-body-container callout-body">
<p>When using the <code>lm()</code> function, we are telling <i>R</i> to fit a model of the form:</p>
<ul>
<li>outcome = intercept + predictor.</li>
</ul>
<p>In this case, <code>salary</code> is the outcome variable, and <code>years_since_phd</code> is the predictor variable. The intercept is, by default, implicitly calculated in the model.</p>
</div>
</div>
<p>By default, this prints in code format as above. However, for the rest of the modules, we will be using a prettier format called <i>markdown</i> format, as such.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(fit) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 21%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 29%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(60)</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">45625.47</td>
<td style="text-align: center;">2473.12</td>
<td style="text-align: center;">(40678.49, 50572.46)</td>
<td style="text-align: center;">18.45</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">years since phd</td>
<td style="text-align: center;">1400.94</td>
<td style="text-align: center;">308.87</td>
<td style="text-align: center;">(783.12, 2018.77)</td>
<td style="text-align: center;">4.54</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This simple regression line is defined by the formula:</p>
<p><span class="math display">\[ y_{\hat{i}} = \beta_0 + \beta_1 x \]</span></p>
<section id="parameter-table" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="parameter-table"><span class="header-section-number">3.1</span> Parameter Table</h2>
<p>From the results output, we can assess each parameter:</p>
<ul>
<li><p>The <code>intercept</code> (<span class="math inline">\(\beta_0\)</span>) is the estimated salary for a professor with zero years since PhD: $45113.71, 95% CI: [$40114.89, 50112.53]. This is significantly different from zero (<i>p</i> &lt; 0.001).</p></li>
<li><p>The coefficient for <code>years_since_phd</code> (<span class="math inline">\(\beta_1\)</span>) is $1400.94, 95% CI: [$783.12, $2018.77]. Therefore, for every additional year of since PhD was associated with an increase of $783.12 to $2018.77. This zero-order effect (since it is the only predictor variable) is significantly different from zero (<i>p</i> &lt; 0.001) at $1400.94.</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="95% CI">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
95% CI
</div>
</div>
<div class="callout-body-container callout-body">
<p>Confidence intervals in the frequentist interpretation is quite wordy but needs to be understood:</p>
<p>“If we repeated the experiment over and over again (with different samples of the same size) and computed the 95% CI in each sample, then 95% of those intervals would contain the population parameter value.”</p>
<p>Alternative, reasonable interpretations can be as follows:</p>
<p>“We can be 95% confident that the 95% CI contains the population mean.”</p>
<ul>
<li>This first alternative isn’t our favorite as it implies a view of probability as belief (which isn’t very frequentist).</li>
</ul>
<p>“The 95% CI contains highly reasonable estimates of the population mean.”</p>
</div>
</div>
</section>
<section id="effect-sizes" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="effect-sizes"><span class="header-section-number">3.2</span> Effect Sizes</h2>
<p>By standardizing the data and then refitting the data, we can calculate the effect size of the <code>years_since_phd</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate effect sizes by standardizing</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#standardize_parameters(fit) |&gt; print_md()</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(fit) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 21%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 29%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(60)</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">45625.47</td>
<td style="text-align: center;">2473.12</td>
<td style="text-align: center;">(40678.49, 50572.46)</td>
<td style="text-align: center;">18.45</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">years since phd</td>
<td style="text-align: center;">1400.94</td>
<td style="text-align: center;">308.87</td>
<td style="text-align: center;">(783.12, 2018.77)</td>
<td style="text-align: center;">4.54</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Using Cohen’s <i>D</i> guidelines, d = 0.51 which is a medium sized effect.</p>
<p>We can also used this standardized model to make the following statement:</p>
<ul>
<li>For every one SD increase in <code>years_since_phd</code>, we would expect a 0.51 increase in <code>salary</code>, <span class="math inline">\(\beta_1\)</span> = 0.51, 95% CI: [0.28, 0.73], <i>p</i>&lt;0.001.</li>
</ul>
</section>
<section id="model-performance" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="model-performance"><span class="header-section-number">3.3</span> Model Performance</h2>
<p>One purpose of model fitting is to demonstrate accurate <i>predictions</i> – given a new X, can we reasonably predict a new Y? (This is different to <i>inference</i>, which is how well these models explain the data).</p>
<p>Three popular metrics of model fit performance in service of prediction are adjusted R^2, AIC, and BIC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate model performance indices</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Indices of model performance</caption>
<thead>
<tr class="header">
<th style="text-align: left;">AIC</th>
<th style="text-align: center;">AICc</th>
<th style="text-align: center;">BIC</th>
<th style="text-align: center;">R2</th>
<th style="text-align: center;">R2 (adj.)</th>
<th style="text-align: center;">RMSE</th>
<th style="text-align: center;">Sigma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1325.90</td>
<td style="text-align: center;">1326.31</td>
<td style="text-align: center;">1332.28</td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">10151.69</td>
<td style="text-align: center;">10319.50</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When comparing models, a higher adjusted R^2 is a better fit, and a lower AIC/BIC is a better fit. Here, we aren’t comparing two competing models, but it is easy to obtain these metrics with our packages.</p>
</section>
<section id="ploting-model-predictions" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="ploting-model-predictions"><span class="header-section-number">3.4</span> Ploting Model Predictions</h2>
<p>Lastly, the model predictions are easy to plot with <code>predict_response</code>. The grey bands show our uncertainty along the best fit line, and you can incorporate data into the plot as well with <code>show_data = TRUE</code>. These plots visualize the parameter estimates we assessed earlier in the parameter tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot model-based predictions</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict_response</span>(fit, <span class="at">terms =</span> <span class="st">"years_since_phd"</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression-review_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict_response</span>(fit, <span class="at">terms =</span> <span class="st">"years_since_phd"</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>(<span class="at">show_data =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Data points may overlap. Use the `jitter` argument to add some amount of
  random variation to the location of data points and avoid overplotting.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="regression-review_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="multiple-regression-examples" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Multiple Regression Examples</h1>
<p>Multiple regression allows us to control for the effects of multiple predictors on the outcome. We will divide our recap across different multiple regression scenarios.</p>
<section id="two-continuous-predictors" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="two-continuous-predictors"><span class="header-section-number">4.1</span> Two Continuous Predictors</h2>
<p>First, we will fit a multiple linear regression with <code>salary</code> as the outcome variable and <code>years_since_phd</code> and <code>n_cites</code> as the predictor variables.</p>
<p>Let’s proceed like before when we introduce a new variable and plot the distribution for <code>n_pubs</code>as a histogram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> yearspubs, <span class="fu">aes</span>(n_pubs)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="regression-review_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here’s how we can use the <code>lm()</code> function to fit a multiple regression with <code>salary</code> as the outcome variable and <code>years_since_phd</code> and <code>n_pubs</code> as the predictor variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit linear model and print parameters</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> salary <span class="sc">~</span> years_since_phd <span class="sc">+</span> n_pubs,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> yearspubs</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(fit2) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 21%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 29%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(59)</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">45113.71</td>
<td style="text-align: center;">2498.17</td>
<td style="text-align: center;">(40114.89, 50112.53)</td>
<td style="text-align: center;">18.06</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">years since phd</td>
<td style="text-align: center;">1075.21</td>
<td style="text-align: center;">406.75</td>
<td style="text-align: center;">(261.30, 1889.11)</td>
<td style="text-align: center;">2.64</td>
<td style="text-align: center;">0.010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">n pubs</td>
<td style="text-align: center;">151.18</td>
<td style="text-align: center;">123.52</td>
<td style="text-align: center;">(-95.98, 398.34)</td>
<td style="text-align: center;">1.22</td>
<td style="text-align: center;">0.226</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This multiple regression is defined by the formula:</p>
<p><span class="math display">\[ y_{\hat{i}} = \beta_0 + \beta_1 x_1 + \beta_2 x_2 \]</span></p>
<p>Multiple regression allows us the ability to control the relationship of multiple predictors on the outcome variable. Statistically “controlling” for a predictors is when the shared variance between predictors is accounted for/removed so that the unique effect of any one predictor variable on the outcome variable is estimated. We then can ask the following questions:</p>
<ul>
<li><p>What is the relationship between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y\)</span> if we hold <span class="math inline">\(x2\)</span> at a constant value? e.g., What is the salary difference between prof A (woman, 10 years) and prof B (woman, 11 years)?</p></li>
<li><p>If we already know <span class="math inline">\(x2\)</span>, how much does learning about <span class="math inline">\(x1\)</span> change our prediction of <span class="math inline">\(y\)</span>? e.g.&nbsp;how much does learning that prof C is male change our prediction of their salary if we already knew they have 15 years of seniority?</p></li>
</ul>
<section id="parameter-table-and-interpretation" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="parameter-table-and-interpretation"><span class="header-section-number">4.1.1</span> Parameter Table and Interpretation</h3>
<p>From the parameter table above, we can make the following statements:</p>
<ul>
<li><p>The intercept is the estimated <code>salary</code> for a professor with zero years since PhD and zero publications: $45113.71, 95% CI: [40114.89,50112.53].</p></li>
<li><p>The <i>partial</i> effect of <code>n_pubs</code> was not significantly different from zero at $151.18. When controlling for <code>years_since_PhD</code>, each additional publication was associated with an additional −$95.98 to $398.34.</p></li>
<li><p>The partial effect of <code>years_since_phd</code> was significantly different from zero at $1075.21. Thus, when controlling for <code>n_pubs</code>, each additional year since PhD was associated with an additional $261.30 to $1889.11.</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Partial Effects vs. Zero-Order Effects">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Partial Effects vs.&nbsp;Zero-Order Effects
</div>
</div>
<div class="callout-body-container callout-body">
<p>When we use multiple regression, the <span class="math inline">\(beta\)</span> predictor parameters are called <b>“partial”</b> (i.e., unique) effects since the model is controlling for each predictors’ influence on the outcome variable.</p>
<p>In contrast, with simple linear regression that has only one predictor, that predictor’s effect is called a <b>“zero-order”</b> (i.e., total) effect.</p>
</div>
</div>
</section>
</section>
<section id="one-dummy-coded-predictor" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="one-dummy-coded-predictor"><span class="header-section-number">4.2</span> One Dummy Coded Predictor</h2>
<p>In cases of a categorical predictor(s), we need to re-coded them such that each of the categories/groups they represent can be mathematically represented as a code variable. All coding systems turn a categorical variable into g-1 code variables.</p>
<ul>
<li>So, for example, if we have 6 groups, we need 5 code variables.</li>
</ul>
<p>The easiest way to turn a categorical predictor into the code variables is to use the <code>factor()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>yearspubs<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(yearspubs<span class="sc">$</span>sex, <span class="at">levels =</span>  <span class="fu">c</span>(<span class="st">"female"</span>,<span class="st">"male"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>It will use the first level (in this case, “female”), as the reference group.</li>
<li>It will name the slope “factorNonref” (e.g., sexMale).</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When we use functions like <code>factor()</code> we have explicitly written out the input arguments, such as <i>levels</i>, in order to show exactly what information the function is processing.</p>
</div>
</div>
<p>In order to interpret the results, it’s important to understand how the code variables are integrated into the model’s formula:</p>
<p><span class="math display">\[ y_{\hat{i}} = \beta_0 + \beta_1 C_1i \]</span></p>
<ul>
<li><p>The intercept <span class="math inline">\(\beta_0\)</span> is the value of <span class="math inline">\(y_{\hat{i}}\)</span> when <span class="math inline">\(C_1\)</span> = 0. In other words, the reference group’s average value.</p></li>
<li><p>The slope <span class="math inline">\(\beta_1\)</span> is the change in <span class="math inline">\(y_{\hat{i}}\)</span> when <span class="math inline">\(C_1 + 1\)</span>. In other words, it is the group difference in average value, and adding it to the intercept means we are focusing on the non-reference group’s outcome value.</p></li>
</ul>
<p>Now, we can fit and interpret the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> salary <span class="sc">~</span> sex, <span class="at">data =</span> yearspubs)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(fit3) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 30%">
<col style="width: 9%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(60)</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">51501.85</td>
<td style="text-align: center;">2214.97</td>
<td style="text-align: center;">(47071.25, 55932.46)</td>
<td style="text-align: center;">23.25</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (male)</td>
<td style="text-align: center;">6441.78</td>
<td style="text-align: center;">2948.02</td>
<td style="text-align: center;">(544.86, 12338.69)</td>
<td style="text-align: center;">2.19</td>
<td style="text-align: center;">0.033</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Therefore:</p>
<ul>
<li><p>The average salary of female academics is $51,502.</p></li>
<li><p>Males academics make $6,442 more on average. So their average salary is $51,502 + $6,442 = $57944</p></li>
</ul>
<section id="estimating-means-and-plot" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="estimating-means-and-plot"><span class="header-section-number">4.2.1</span> Estimating means and plot</h3>
<p>We will use the <code>estimate_means()</code> function to accomplish the same thing we did above to obtain average values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>gmeans1 <span class="ot">&lt;-</span> <span class="fu">estimate_means</span>(fit3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>We selected `by = c("sex")`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>gmeans1 <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Estimated Marginal Means</caption>
<thead>
<tr class="header">
<th style="text-align: left;">sex</th>
<th style="text-align: left;">Mean</th>
<th style="text-align: left;">SE</th>
<th style="text-align: left;">95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: left;">51501.85</td>
<td style="text-align: left;">2214.97</td>
<td style="text-align: left;">(47071.25, 55932.46)</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: left;">57943.63</td>
<td style="text-align: left;">1945.43</td>
<td style="text-align: left;">(54052.18, 61835.07)</td>
</tr>
</tbody>
</table>
<p>Marginal means estimated at sex</p>
</div>
</div>
<p>Lastly, we can visualize like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gmeans1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression-review_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="contrast" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="contrast"><span class="header-section-number">4.2.2</span> Contrast</h3>
<p>To see if this apparent difference of average salary between male and female academics is statistically significant, we can perform a <i>contrast</i>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>contrasts <span class="ot">&lt;-</span> <span class="fu">estimate_contrasts</span>(fit3, <span class="at">contrast =</span> <span class="st">"sex"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>contrasts <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Marginal Contrasts Analysis</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 16%">
<col style="width: 31%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Level1</th>
<th style="text-align: right;">Level2</th>
<th style="text-align: right;">Difference</th>
<th style="text-align: left;">95% CI</th>
<th style="text-align: left;">SE</th>
<th style="text-align: left;">t(60)</th>
<th style="text-align: left;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">male</td>
<td style="text-align: right;">-6441.78</td>
<td style="text-align: left;">(-12338.69, -544.86)</td>
<td style="text-align: left;">2948.02</td>
<td style="text-align: left;">-2.19</td>
<td style="text-align: left;">0.033</td>
</tr>
</tbody>
</table>
<p>Marginal contrasts estimated at sex p-value adjustment method: Holm (1979)</p>
</div>
</div>
<p>Therefore, there is a statistically significant difference between male and female academics, <i>p</i> &lt; 0.05.</p>
</section>
</section>
<section id="one-continuous-and-one-dummy-coded-predictor" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="one-continuous-and-one-dummy-coded-predictor"><span class="header-section-number">4.3</span> One Continuous and One Dummy Coded Predictor</h2>
<p>Now, we will fit a multiple linear regression with <code>salary</code> as the outcome variable and with <code>years_since_phd</code> and <code>sex</code> as the predictor variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit linear model and print parameters</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> salary <span class="sc">~</span> years_since_phd <span class="sc">+</span> sex,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> yearspubs</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(fit4) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 21%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 29%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(59)</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">43989.01</td>
<td style="text-align: center;">2667.12</td>
<td style="text-align: center;">(38652.12, 49325.91)</td>
<td style="text-align: center;">16.49</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">years since phd</td>
<td style="text-align: center;">1300.30</td>
<td style="text-align: center;">312.36</td>
<td style="text-align: center;">(675.28, 1925.32)</td>
<td style="text-align: center;">4.16</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male)</td>
<td style="text-align: center;">4109.49</td>
<td style="text-align: center;">2673.09</td>
<td style="text-align: center;">(-1239.35, 9458.34)</td>
<td style="text-align: center;">1.54</td>
<td style="text-align: center;">0.130</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="estimating-means" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="estimating-means"><span class="header-section-number">4.3.1</span> Estimating Means</h3>
<p>Recall that prior to fitting the multiple regression, we changed <code>sex</code> into a categorical variable using the <code>factor()</code> function. This is an example of <i>dummy coding</i>. Therefore, once we fit the multiple regression we were able to separate response values based on different factor levels.</p>
<p>In the case of <code>sex</code>, we have a binary categorical variable, so we can obtain average values of <code>salary</code> at each level of sex while also accounting for (i.e.&nbsp;controlling for) the (partial) effect of <code>years_since_phd</code>.</p>
<p>We will use the <code>estimate_means()</code> function to accomplish this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>gmeans <span class="ot">&lt;-</span> <span class="fu">estimate_means</span>(fit4, <span class="at">by =</span> <span class="st">"sex"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>gmeans <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Estimated Marginal Means</caption>
<thead>
<tr class="header">
<th style="text-align: left;">sex</th>
<th style="text-align: left;">Mean</th>
<th style="text-align: left;">SE</th>
<th style="text-align: left;">95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: left;">52818.46</td>
<td style="text-align: left;">1989.11</td>
<td style="text-align: left;">(48838.27, 56798.66)</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: left;">56927.96</td>
<td style="text-align: left;">1742.00</td>
<td style="text-align: left;">(53442.23, 60413.69)</td>
</tr>
</tbody>
</table>
<p>Marginal means estimated at sex</p>
</div>
</div>
<p>We can also create a plot to visualize the means.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression-review_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can now more easily see that, across all <code>years_since_phd</code> values, male academics earn on average <i>more</i> salary than women academics. However, as the plot shows, there is variability within each factor level.</p>
<p>To see if this apparent difference of average salary between male and female academics is statistically significant, we can perform a <i>contrast</i>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>contrasts <span class="ot">&lt;-</span> <span class="fu">estimate_contrasts</span>(fit4, <span class="at">contrast =</span> <span class="st">"sex"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>contrasts <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Marginal Contrasts Analysis</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 16%">
<col style="width: 30%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Level1</th>
<th style="text-align: right;">Level2</th>
<th style="text-align: right;">Difference</th>
<th style="text-align: left;">95% CI</th>
<th style="text-align: left;">SE</th>
<th style="text-align: left;">t(59)</th>
<th style="text-align: left;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">male</td>
<td style="text-align: right;">-4109.49</td>
<td style="text-align: left;">(-9458.34, 1239.35)</td>
<td style="text-align: left;">2673.09</td>
<td style="text-align: left;">-1.54</td>
<td style="text-align: left;">0.130</td>
</tr>
</tbody>
</table>
<p>Marginal contrasts estimated at sex p-value adjustment method: Holm (1979)</p>
</div>
</div>
<p>Therefore, there is not a statistically significant difference in means across <code>years_since_phd</code> between male and female academics, <i>p</i> = 0.130</p>
</section>
</section>
<section id="moderation" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="moderation"><span class="header-section-number">4.4</span> Moderation</h2>
<p>Moderation, also known as interactions, asks us to consider the extent to which the effect of one predictor <b> depends on </b> the value on another predictor. It is up to the investigator, guided by theory and previous research, to consider if including interaction terms are relevant for the research question.</p>
<p>Again, with moderation we include interaction terms like so:</p>
<p><span class="math display">\[ y_{\hat{i}} = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_1 x_2\]</span> - <span class="math inline">\(beta_3\)</span> is the slope of the interaction term (the product of two or more predictors)</p>
<p>We can now fit our new model with the interaction term:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit linear model and print parameters</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the * (asterisk) is short form for including the interation term</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> salary <span class="sc">~</span> years_since_phd <span class="sc">*</span> sex,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> yearspubs</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(fit5) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 32%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 25%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(58)</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">45072.28</td>
<td style="text-align: center;">4462.64</td>
<td style="text-align: center;">(36139.34, 54005.22)</td>
<td style="text-align: center;">10.10</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">years since phd</td>
<td style="text-align: center;">1112.81</td>
<td style="text-align: center;">692.27</td>
<td style="text-align: center;">(-272.92, 2498.54)</td>
<td style="text-align: center;">1.61</td>
<td style="text-align: center;">0.113</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male)</td>
<td style="text-align: center;">2656.21</td>
<td style="text-align: center;">5486.15</td>
<td style="text-align: center;">(-8325.51, 13637.92)</td>
<td style="text-align: center;">0.48</td>
<td style="text-align: center;">0.630</td>
</tr>
<tr class="even">
<td style="text-align: left;">years since phd × sex (male)</td>
<td style="text-align: center;">236.36</td>
<td style="text-align: center;">777.28</td>
<td style="text-align: center;">(-1319.53, 1792.25)</td>
<td style="text-align: center;">0.30</td>
<td style="text-align: center;">0.762</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In this example, the <code>years_since_phd</code> by <code>sex</code> interaction term was not significant (p = 0.762).</p>
<p>We can visualize the interaction by making a marginal effects, or “spotlight”, plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ggpredict</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> fit5,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"years_since_phd"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"sex"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression-review_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that in this multiple regression / moderation model that each level of <code>sex</code> has a different slope. We can estimate these slopes, or the “simple” effect of <code>years_since_phd</code> on salary for each level of <code>sex</code>, with <code>estimate_slopes()</code>. The term “simple” is a result of adding the interaction term in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">estimate_slopes</span>(fit5, <span class="at">trend =</span> <span class="st">"years_since_phd"</span>, <span class="at">by =</span> <span class="st">"sex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated Marginal Effects

sex    | Coefficient |     SE |             95% CI | t(58) |      p
-------------------------------------------------------------------
female |     1112.81 | 692.27 | [-272.92, 2498.54] |  1.61 | 0.113 
male   |     1349.17 | 353.44 | [ 641.69, 2056.65] |  3.82 | &lt; .001
Marginal effects estimated for years_since_phd</code></pre>
</div>
</div>
<ul>
<li>In this moderation model, the simple slope of the <code>years_since_phd</code> was significantly different from zero for men at $1349.17, but not for women (p = 0.113).</li>
</ul>
</section>
</section>
<section id="assumptions" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Assumptions</h1>
<p>The six assumptions of general linear models can be divided into two general areas.</p>
<p><u>Assumptions about the Formula</u></p>
<ul>
<li>Correct Functional Form</li>
<li>Perfectly Measured Preditors</li>
<li>No Collinearity/Multicollinearity</li>
</ul>
<p><u> Assumptions about the Residuals</u></p>
<ul>
<li>Constant Error Variance</li>
<li>Independence of Residuals</li>
<li>Normality of Residuals</li>
</ul>
<p>When we utilize GLMs, we are trying to do better than assume that each of these six assumption of general linear models holds. One way to test some of these assumptions visually is to use the <code>check_model()</code> function. As an example will apply these checks on the multiple regression model without the interaction term.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression-review_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As you can see, this is an easy way to check for assumptions. Given this model, the assumptions seem to fit well. But in the future GLM models, these assumptions will no longer be reasonable.</p>
</section>
<section id="conclusion" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Conclusion</h1>
<p>In this recap, we fit simple and multiple regression models with interaction terms. This is great starting point for learning about GLMs. In the future modules, we will take our understanding and interpretations of general linear models into GLMs and learn when GLMs are most appropriate, especially when assumptions do not hold.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>ggplot() also from the <code>tidyverse</code> package.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./linear-models.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Introduction to Generalized Linear Modeling was written by Aaron Matthew Simmons and Jeffrey M. Girard.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>